<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swajay Time Tracker - Cloud</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 100%;
            padding: 40px;
        }

        .admin-container {
            max-width: 1400px;
        }

        .company-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #1e3c72;
        }

        .company-logo {
            font-size: 48px;
            font-weight: bold;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .company-tagline {
            color: #7f8c8d;
            font-size: 14px;
            font-style: italic;
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }

        .header-panel {
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }

        .header-panel h1,
        .header-panel h2,
        .header-panel p {
            color: #FFD700 !important;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
        }

        .header-panel h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header-panel h2 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header-panel p {
            font-size: 18px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #34495e;
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #dfe6e9;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #3498db;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #27ae60, #229954);
            color: white;
        }

        .btn-block {
            width: 100%;
            margin-bottom: 10px;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #7f8c8d;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }

        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .access-type-banner {
            background: #e8f5e9;
            border: 2px solid #27ae60;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .access-type-banner.admin {
            background: #fff3cd;
            border-color: #f39c12;
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            padding: 15px;
            background: #ecf0f1;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab.active {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .employee-card {
            background: white;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-working {
            background: #d4edda;
            color: #155724;
        }

        .status-offline {
            background: #f8d7da;
            color: #721c24;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .admin-tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBXB2fRIPJno4-n7nDjsqLBDqDbeXqyJF0",
            authDomain: "swajay-tracker.firebaseapp.com",
            projectId: "swajay-tracker",
            storageBucket: "swajay-tracker.firebasestorage.app",
            messagingSenderId: "837367397930",
            appId: "1:837367397930:web:7dfca3bdea800be72a0d53"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Check if Windows
        function isWindows() {
            return /Windows/.test(navigator.userAgent) || /Win/.test(navigator.platform);
        }

        // Get access type from URL
        const urlParams = new URLSearchParams(window.location.search);
        const isAdmin = urlParams.get('access') === 'admin';

        class SwajayApp {
            constructor() {
                this.currentUser = null;
                this.currentTab = 'dashboard';
                this.init();
            }

            async init() {
                // Check Windows
                if (!isWindows()) {
                    document.getElementById('app').innerHTML = `
                        <div class="container">
                            <div class="company-header">
                                <div class="company-logo">SWAJAY</div>
                                <div class="company-tagline">Professional Time Management System</div>
                            </div>
                            <div class="alert alert-info">
                                <strong>‚ö†Ô∏è Windows Only</strong><br>
                                This application requires Windows operating system.
                            </div>
                        </div>
                    `;
                    return;
                }

                this.showLoginPage();
            }

            showLoginPage() {
                const accessType = isAdmin ? 'Admin' : 'Employee';
                const accessClass = isAdmin ? 'admin' : '';
                
                document.getElementById('app').innerHTML = `
                    <div class="container">
                        <div class="company-header">
                            <div class="company-logo">SWAJAY</div>
                            <div class="company-tagline">Professional Time Management System - Cloud Edition</div>
                        </div>

                        <div class="access-type-banner ${accessClass}">
                            ${isAdmin ? 'üîê' : '‚úì'} ${accessType} Access Portal
                        </div>

                        <h1>Time Tracker Login</h1>

                        <div class="form-group">
                            <label for="userId">${accessType} ID</label>
                            <input type="text" id="userId" placeholder="Enter your ${accessType} ID">
                        </div>

                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" id="password" placeholder="Enter your password">
                        </div>

                        <button class="btn btn-primary btn-block" onclick="app.login()">
                            Login
                        </button>

                        <div style="text-align: center; margin-top: 20px; font-size: 12px; color: #7f8c8d;">
                            First time? Contact your admin for credentials<br>
                            Need help? Email: support@swajay.com
                        </div>
                    </div>
                `;

                // Enter key to login
                document.getElementById('password').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.login();
                });
            }

            async login() {
                const userId = document.getElementById('userId').value.trim();
                const password = document.getElementById('password').value;

                if (!userId || !password) {
                    alert('Please enter both ID and password!');
                    return;
                }

                document.getElementById('app').innerHTML = '<div class="container"><div class="loading">üîÑ Logging in...</div></div>';

                try {
                    if (isAdmin) {
                        // Admin login
                        const adminDoc = await db.collection('admins').doc(userId).get();
                        
                        if (!adminDoc.exists) {
                            alert('Invalid admin credentials!');
                            this.showLoginPage();
                            return;
                        }

                        const adminData = adminDoc.data();
                        if (adminData.password === password) {
                            this.currentUser = { id: userId, ...adminData, isAdmin: true };
                            this.showAdminDashboard();
                        } else {
                            alert('Invalid admin credentials!');
                            this.showLoginPage();
                        }
                    } else {
                        // Employee login
                        const empDoc = await db.collection('employees').doc(userId).get();
                        
                        if (!empDoc.exists) {
                            alert('Invalid employee credentials!');
                            this.showLoginPage();
                            return;
                        }

                        const empData = empDoc.data();
                        if (empData.password === password) {
                            this.currentUser = { id: userId, ...empData };
                            this.showEmployeeDashboard();
                        } else {
                            alert('Invalid employee credentials!');
                            this.showLoginPage();
                        }
                    }
                } catch (error) {
                    console.error('Login error:', error);
                    alert('Error logging in: ' + error.message);
                    this.showLoginPage();
                }
            }

            async showEmployeeDashboard() {
                document.getElementById('app').innerHTML = `
                    <div class="container">
                        <div class="company-header">
                            <div class="company-logo">SWAJAY</div>
                            <div class="company-tagline">Professional Time Management System</div>
                        </div>

                        <div class="header-panel">
                            <h2>Welcome, ${this.currentUser.name}</h2>
                            <p>Employee ID: ${this.currentUser.id}</p>
                        </div>

                        <div class="alert alert-success">
                            ‚úÖ You're logged in and connected to cloud database!<br>
                            Your time is being tracked automatically.
                        </div>

                        <button class="btn btn-success btn-block" onclick="app.logout()">
                            Logout
                        </button>
                    </div>
                `;
            }

            async showAdminDashboard() {
                this.currentTab = 'employees';
                
                document.getElementById('app').innerHTML = `
                    <div class="container admin-container">
                        <div class="company-header">
                            <div class="company-logo">SWAJAY</div>
                            <div class="company-tagline">Admin Control Panel - Cloud Edition</div>
                        </div>

                        <div class="header-panel">
                            <h1>üë®‚Äçüíº Admin Dashboard</h1>
                            <p>Welcome, ${this.currentUser.name}</p>
                        </div>

                        <div class="admin-tabs">
                            <button class="tab ${this.currentTab === 'employees' ? 'active' : ''}" onclick="app.switchTab('employees')">
                                üë• Employees
                            </button>
                            <button class="tab ${this.currentTab === 'settings' ? 'active' : ''}" onclick="app.switchTab('settings')">
                                ‚öôÔ∏è Settings
                            </button>
                        </div>

                        <div id="admin-content"></div>

                        <button class="btn btn-primary btn-block" onclick="app.logout()" style="margin-top: 20px;">
                            ‚Üê Logout
                        </button>
                    </div>
                `;

                this.renderAdminContent();
            }

            async renderAdminContent() {
                const content = document.getElementById('admin-content');
                
                if (this.currentTab === 'employees') {
                    content.innerHTML = '<div class="loading">Loading employees...</div>';
                    
                    try {
                        const snapshot = await db.collection('employees').get();
                        const employees = [];
                        snapshot.forEach(doc => {
                            employees.push({ id: doc.id, ...doc.data() });
                        });

                        content.innerHTML = `
                            <button class="btn btn-success" onclick="app.showAddEmployee()">
                                ‚ûï Add New Employee
                            </button>

                            <h3 style="margin: 20px 0;">Employee List (${employees.length} employees)</h3>

                            <div id="employee-list">
                                ${employees.length === 0 ? 
                                    '<div class="alert alert-info">No employees yet. Add your first employee!</div>' :
                                    employees.map(emp => `
                                        <div class="employee-card">
                                            <strong>${emp.name}</strong>
                                            <br>ID: ${emp.id}
                                            <br>Email: ${emp.email || 'N/A'}
                                            <span class="status-badge status-offline">Cloud Synced</span>
                                        </div>
                                    `).join('')
                                }
                            </div>
                        `;
                    } catch (error) {
                        content.innerHTML = `<div class="alert alert-info">Error loading employees: ${error.message}</div>`;
                    }
                } else if (this.currentTab === 'settings') {
                    content.innerHTML = `
                        <div class="alert alert-success">
                            <strong>‚úÖ Firebase Cloud Database Connected!</strong><br>
                            Project: swajay-tracker<br>
                            Status: Active<br>
                            All data is synced across all computers automatically.
                        </div>

                        <h3>System Information</h3>
                        <p>Version: 1.0 Cloud Edition</p>
                        <p>Database: Firebase Firestore</p>
                        <p>Sync: Real-time</p>
                    `;
                }
            }

            async showAddEmployee() {
                const name = prompt('Employee Full Name:');
                if (!name) return;

                const id = prompt('Employee ID (e.g., SWAJAY001):');
                if (!id) return;

                const email = prompt('Employee Email (optional):');
                const password = prompt('Employee Password:');
                if (!password) return;

                try {
                    await db.collection('employees').doc(id).set({
                        name: name,
                        email: email || '',
                        password: password,
                        createdAt: new Date().toISOString()
                    });

                    alert(`‚úÖ Employee created!\n\nEmployee ID: ${id}\nPassword: ${password}\n\nShare these credentials with ${name}`);
                    this.renderAdminContent();
                } catch (error) {
                    alert('Error creating employee: ' + error.message);
                }
            }

            switchTab(tab) {
                this.currentTab = tab;
                this.showAdminDashboard();
            }

            logout() {
                this.currentUser = null;
                this.showLoginPage();
            }
        }

        // Initialize default admin if doesn't exist
        db.collection('admins').doc('admin').get().then(doc => {
            if (!doc.exists) {
                db.collection('admins').doc('admin').set({
                    name: 'System Administrator',
                    password: 'admin123',
                    email: 'admin@swajay.com',
                    createdAt: new Date().toISOString()
                });
                console.log('‚úÖ Default admin created');
            }
        });

        // Start app
        const app = new SwajayApp();
    </script>
</body>
</html>
